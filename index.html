<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>Jersey 選單 - 獨立圖片版本</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 20px; }
    section { display: none; margin-top: 20px; }
    .active { display: block; }
    .option {
      display: inline-block;
      margin: 10px;
    }
    .option-img {
      width: 160px;
      cursor: pointer;
      border: 2px solid transparent;
      transition: border 0.3s;
    }
    .option-img:hover {
      border: 2px solid red;
    }
    .caption {
      margin-top: 5px;
      font-size: 14px;
      color: #333;
    }
    .grid { display: flex; flex-wrap: wrap; justify-content: center; }
    #submit-btn {
      display: inline-block;
      margin-top: 30px;
      padding: 12px 24px;
      background-color: #007bff;
      color: white;
      border-radius: 6px;
      font-size: 18px;
      text-decoration: none;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h2>Jersey 圖片選單</h2>
  <section id="step1" class="active">
    <h3>1. 選擇運動類型</h3>
    <div class="grid">
      <div class="option">
        <img src="images/basketball.jpg" class="option-img" onclick="selectSport('籃球')">
        <div class="caption">籃球</div>
      </div>
      <div class="option">
        <img src="images/volleyball.jpg" class="option-img" onclick="selectSport('排球')">
        <div class="caption">排球</div>
      </div>
      <div class="option">
        <img src="images/badminton.jpg" class="option-img" onclick="selectSport('羽球')">
        <div class="caption">羽球</div>
      </div>
    </div>
  </section>
  <section id="step2">
    <h3>2. 選擇品項</h3>
    <div class="grid" id="item-options"></div>
  </section>
  <section id="step3">
    <h3>3. 選擇款式</h3>
    <div class="grid" id="style-options"></div>
  </section>
  <section id="step4">
    <h3>4. 選擇配色</h3>
    <div class="grid" id="color-options"></div>
    <button id="submit-btn" onclick="openForm()" disabled>前往填寫表單</button>
  </section>
<script>
let selections = { sport: '', item: '', style: '', color: '' };
const sportData = {
  "籃球": ["雙面球衣+單面球褲", "單面球衣*2+單面球褲", "單面球衣*2+單面球褲*2"],
  "排球": ["排球上衣", "排球上衣+排球褲"],
  "羽球": ["排球上衣", "排球上衣+排球褲"]
};
const styleColors = {
  "S42": ["SV","BK","PP","CB","DR","GL"], "S43": ["BK","PP","DE","CR","AY","GL"],
  "V41": ["PP","BK"], "B21": ["BK","CB"]
};
function showStep(id) {
  document.querySelectorAll("section").forEach(s => s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}
function cleanFileName(str) {
  return str.replaceAll("+", "x").replaceAll("*", "x").replaceAll("｜", "-");
}
function selectSport(sport) {
  selections.sport = sport;
  const container = document.getElementById("item-options");
  container.innerHTML = "";
  sportData[sport].forEach(item => {
    const fname = `images/${cleanFileName(sport)}_${cleanFileName(item)}_item.jpg`;
    const div = document.createElement("div");
    div.className = "option";
    div.innerHTML = `<img src="${fname}" class="option-img" onclick="selectItem('${item}')"><div class='caption'>${item}</div>`;
    container.appendChild(div);
  });
  showStep("step2");
}
function selectItem(item) {
  selections.item = item;
  const container = document.getElementById("style-options");
  container.innerHTML = "";
  Object.keys(styleColors).forEach(style => {
    const sport = style.startsWith("S") ? "籃球" : style.startsWith("V") ? "排球" : "羽球";
    if (selections.sport !== sport) return;
    const fname = `images/${cleanFileName(sport)}_${cleanFileName(item)}_${style}.jpg`;
    const div = document.createElement("div");
    div.className = "option";
    div.innerHTML = `<img src="${fname}" class="option-img" onclick="selectStyle('${style}')"><div class='caption'>${style}</div>`;
    container.appendChild(div);
  });
  showStep("step3");
}
function selectStyle(style) {
  selections.style = style;
  const container = document.getElementById("color-options");
  container.innerHTML = "";
  const colors = styleColors[style] || [];
  colors.forEach(color => {
    const label = `${style}-${color}`;
    const fname = `images/${cleanFileName(selections.sport)}_${cleanFileName(selections.item)}_${label}.jpg`;
    const div = document.createElement("div");
    div.className = "option";
    div.innerHTML = `<img src="${fname}" class="option-img" onclick="selectColor('${label}', this)"><div class='caption'>${label}</div>`;
    container.appendChild(div);
  });
  showStep("step4");
}
function selectColor(label, element) {
  selections.color = label;
  document.querySelectorAll(".option-img").forEach(i => i.style.border = "2px solid transparent");
  element.style.border = "2px solid red";
  document.getElementById("submit-btn").disabled = false;
}
function openForm() {
  const base = "https://ap9.ragic.com/jersey/forms6/16";
  const params = [
    "webview", "webaction=form", "ver=new", "version=2",
    `pfv1001193=${encodeURIComponent(selections.sport)}`,
    `pfv1000069=${encodeURIComponent(selections.item)}`,
    `pfv1002088=${encodeURIComponent("短版球褲")}`,
    `pfv1000071=${encodeURIComponent(selections.style)}`,
    `pfv1001153=${encodeURIComponent(selections.color)}`
  ].join("&");
  const url = `${base}?${params}`;
  const popup = window.open(url, "RagicForm", "width=1000,height=800");
  if (!popup || popup.closed || typeof popup.closed === "undefined") {
    window.location.href = url;
  }
}
</script>
</body>
</html>
