<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SGB 款式挑選系統</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #d33;
      --glass-bg: rgba(0, 0, 0, 0.6);
      --accent-color: #007bff;
    }

    html, body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      font-family: 'Noto Sans TC', sans-serif;
      color: #fff;
      background-color: #000;
      background-image: url('images/background/bg-desktop.jpg');
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
      background-attachment: fixed;
    }

    /* 手機背景適配 */
    @media (max-width: 768px) {
      body {
        background-image: url('images/background/bg-mobile.jpg');
        background-attachment: scroll;
      }
    }

    /* 步驟進度條 */
    .progress-container {
      position: sticky;
      top: 0;
      z-index: 100;
      background: rgba(0,0,0,0.8);
      padding: 15px 10px;
      margin-bottom: 20px;
      display: flex;
      justify-content: center;
      gap: 5px;
    }
    .step-dot {
      width: 30px;
      height: 8px;
      background: #444;
      border-radius: 4px;
      transition: all 0.3s;
    }
    .step-dot.active {
      background: var(--primary-color);
      width: 50px;
    }

    section {
      display: none;
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.5s ease, transform 0.5s ease;
    }
    section.active {
      display: block;
      opacity: 1;
      transform: translateY(0);
    }

    h2, h3 {
      text-shadow: 0 2px 10px rgba(0,0,0,0.8);
      margin-bottom: 20px;
    }

    .container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      background: var(--glass-bg);
      padding: 30px 15px;
      border-radius: 20px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.1);
    }

    .option {
      flex: 0 0 calc(50% - 20px);
      max-width: 200px;
      cursor: pointer;
      opacity: 0;
      transform: scale(0.9);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    .option.show {
      opacity: 1;
      transform: scale(1);
    }

    .option-img {
      width: 100%;
      aspect-ratio: 1/1;
      object-fit: cover;
      border-radius: 12px;
      border: 3px solid transparent;
      transition: all 0.3s;
      background: #222;
    }
    .option:hover .option-img {
      border-color: var(--accent-color);
      transform: translateY(-8px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.5);
    }

    .label {
      margin-top: 12px;
      font-size: 16px;
      font-weight: bold;
    }

    /* 按鈕樣式 */
    .btn-group {
      margin-top: 30px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
    }
    .back-btn {
      padding: 10px 25px;
      background: transparent;
      color: #ccc;
      border: 1px solid #666;
      border-radius: 50px;
      cursor: pointer;
    }
    .back-btn:hover { color: #fff; border-color: #fff; }

    .submit-btn {
      padding: 15px 40px;
      font-size: 20px;
      font-weight: bold;
      background: #fff;
      color: #000;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
    }
    .submit-btn:hover { background: var(--primary-color); color: #fff; }

    /* 總結區塊 */
    .summary-card {
      text-align: left;
      display: inline-block;
      margin-bottom: 20px;
      padding: 20px;
      background: rgba(255,255,255,0.1);
      border-radius: 10px;
      line-height: 2;
    }
    .summary-card span { color: var(--primary-color); font-weight: bold; }

    @media (max-width: 480px) {
      .option { flex: 0 0 calc(50% - 10px); }
      .label { font-size: 14px; }
    }
  </style>
</head>
<body>

<div class="progress-container" id="progressBar">
  <div class="step-dot active"></div>
  <div class="step-dot"></div>
  <div class="step-dot"></div>
  <div class="step-dot"></div>
  <div class="step-dot"></div>
  <div class="step-dot"></div>
  <div class="step-dot"></div>
</div>

<h2 style="text-align:center">SGB 款式挑選</h2>

<section id="step1" class="active">
  <h3>1. 選擇運動類型</h3>
  <div class="container" id="sports"></div>
</section>

<section id="step2">
  <h3>2. 選擇品項</h3>
  <div class="container" id="items"></div>
  <div class="btn-group"><button class="back-btn" onclick="showStep('step1')">返回上一步</button></div>
</section>

<section id="step3">
  <h3>3. 選擇球衣版型</h3>
  <div class="container" id="jerseyTypes"></div>
  <div class="btn-group"><button class="back-btn" onclick="showStep('step2')">返回上一步</button></div>
</section>

<section id="step4">
  <h3>4. 選擇球褲版型</h3>
  <div class="container" id="shortsTypes"></div>
  <div class="btn-group"><button class="back-btn" onclick="showStep('step3')">返回上一步</button></div>
</section>

<section id="step5">
  <h3>5. 選擇款式</h3>
  <div class="container" id="styles"></div>
  <div class="btn-group"><button class="back-btn" id="backToStep5">返回上一步</button></div>
</section>

<section id="step6">
  <h3>6. 選擇配色</h3>
  <div class="container" id="colors"></div>
  <div class="btn-group"><button class="back-btn" id="backToStep6">返回上一步</button></div>
</section>

<section id="step7">
  <h3>7. 確認您的選擇</h3>
  <div class="container">
    <div class="summary-card" id="summary"></div>
    <div style="width: 100%; text-align: center;">
      <button class="submit-btn" onclick="goToRagic()">前往填寫設計表單</button>
    </div>
  </div>
  <div class="btn-group"><button class="back-btn" onclick="showStep('step6')">返回修改配色</button></div>
</section>

<script>
// 資料保持不變 (節錄部分示範，請延用您原有的完整 data 物件)
const imageLabelMap = { /* 延用您的內容 */ };
const data = { /* 延用您的完整 data 物件 */ };

let selections = { sport: "", item: "", jerseyType: "", shortsType: "無", style: "", color: "" };

function showStep(stepId) {
  const allSections = document.querySelectorAll('section');
  const stepIndex = parseInt(stepId.replace('step', '')) - 1;
  
  allSections.forEach(s => {
    s.classList.remove('active');
    setTimeout(() => { if(s.id !== stepId) s.style.display = 'none'; }, 500);
  });

  const target = document.getElementById(stepId);
  target.style.display = 'block';
  window.scrollTo({ top: 0, behavior: 'smooth' });
  setTimeout(() => target.classList.add('active'), 50);

  // 更新進度條
  const dots = document.querySelectorAll('.step-dot');
  dots.forEach((dot, idx) => {
    dot.classList.toggle('active', idx <= stepIndex);
  });

  if(stepId === 'step7') renderSummary();
}

function createOption(imgSrc, label, callback, index = 0) {
  const div = document.createElement('div');
  div.className = 'option';
  div.innerHTML = `
    <img src="${imgSrc}" class="option-img" loading="lazy" onerror="this.src='images/default.png'">
    <div class="label">${label.replace('<br>', ' ')}</div>
  `;
  div.onclick = callback;
  setTimeout(() => div.classList.add('show'), index * 50);
  return div;
}

function init() {
  const sportDiv = document.getElementById('sports');
  Object.keys(data).forEach((sport, idx) => {
    const imgSrc = `images/sports/${imageLabelMap[sport] || sport}.png`;
    sportDiv.appendChild(createOption(imgSrc, sport, () => {
      selections.sport = sport;
      showItems(sport);
    }, idx));
  });
}

function showItems(sport) {
  const div = document.getElementById('items');
  div.innerHTML = '';
  Object.keys(data[sport].items).forEach((item, idx) => {
    div.appendChild(createOption(`images/items/${imageLabelMap[item] || item}.png`, item, () => {
      selections.item = item;
      // 邏輯判斷：練習衣跳過版型
      if (item.includes("練習衣")) {
        selections.jerseyType = "練習衣";
        selections.style = "T01";
        showColors(sport, "T01");
      } else {
        showJerseyTypes(sport, item);
      }
    }, idx));
  });
  showStep('step2');
}

function showJerseyTypes(sport, item) {
  const div = document.getElementById('jerseyTypes');
  div.innerHTML = '';
  data[sport].items[item].forEach((type, idx) => {
    if (sport === "羽球" && type === "拉克蘭袖") return;
    div.appendChild(createOption(`images/styles/${imageLabelMap[type] || type}.png`, type, () => {
      selections.jerseyType = type;
      sport === '籃球' ? showShortsTypes(sport) : showStyles(sport, type);
    }, idx));
  });
  showStep('step3');
}

function showShortsTypes(sport) {
  const div = document.getElementById('shortsTypes');
  div.innerHTML = '';
  data[sport].shorts.forEach((type, idx) => {
    div.appendChild(createOption(`images/styles/${imageLabelMap[type] || type}.png`, type, () => {
      selections.shortsType = type;
      showStyles(sport, selections.jerseyType);
    }, idx));
  });
  showStep('step4');
}

function showStyles(sport, jerseyType) {
  const div = document.getElementById('styles');
  div.innerHTML = '';
  data[sport].styles[jerseyType].forEach((style, idx) => {
    div.appendChild(createOption(`images/styles/${style}.png`, style, () => {
      selections.style = style;
      showColors(sport, style);
    }, idx));
  });
  document.getElementById('backToStep5').onclick = () => showStep(sport === '籃球' ? 'step4' : 'step3');
  showStep('step5');
}

function showColors(sport, style) {
  const div = document.getElementById('colors');
  div.innerHTML = '';
  (data[sport].colors[style] || []).forEach((color, idx) => {
    const label = `${style}-${color}`;
    div.appendChild(createOption(`images/colors/${label}.png`, label, () => {
      selections.color = label;
      showStep('step7');
    }, idx));
  });
  document.getElementById('backToStep6').onclick = () => {
    selections.item.includes("練習衣") ? showStep('step2') : showStep('step5');
  };
  showStep('step6');
}

function renderSummary() {
  const div = document.getElementById('summary');
  div.innerHTML = `
    <p>運動類型：<span>${selections.sport}</span></p>
    <p>選擇品項：<span>${selections.item.replace('<br>', ' ')}</span></p>
    <p>球衣版型：<span>${selections.jerseyType}</span></p>
    ${selections.sport === '籃球' ? `<p>球褲版型：<span>${selections.shortsType}</span></p>` : ''}
    <p>選擇款式：<span>${selections.style}</span></p>
    <p>選擇配色：<span>${selections.color}</span></p>
  `;
}

function goToRagic() {
  const base = "https://ap9.ragic.com/jersey/forms6/16";
  const params = new URLSearchParams({
    webview: "", webaction: "form", ver: "new", version: "2",
    pfv1001193: selections.sport,
    pfv1000069: selections.item,
    pfv1002088: selections.shortsType,
    pfv1000071: selections.style,
    pfv1001153: selections.color
  });
  window.open(`${base}?${params.toString()}`, '_blank');
}

init();
</script>
</body>
</html>
